{"version":3,"file":"bundles/cb51be0e75c2e926185d/7766.js","mappings":"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","sources":["webpack://element-web/./src/components/views/location/LiveDurationDropdown.tsx","webpack://element-web/./src/components/views/location/shareLocation.ts","webpack://element-web/./src/components/views/location/LocationPicker.tsx","webpack://element-web/./src/components/views/location/ShareDialogButtons.tsx","webpack://element-web/./src/components/views/location/ShareType.tsx","webpack://element-web/./src/components/views/location/EnableLiveShare.tsx","webpack://element-web/./src/components/views/location/LocationShareMenu.tsx","webpack://element-web/./src/components/views/location/LocationButton.tsx","webpack://element-web/./src/components/views/location/Marker.tsx","webpack://element-web/./src/components/views/rooms/CollapsibleButton.tsx","webpack://element-web/./src/components/views/rooms/EmojiButton.tsx","webpack://element-web/./src/components/views/rooms/MessageComposerButtons.tsx"],"sourcesContent":["/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2022 The Matrix.org Foundation C.I.C.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport React, { type ReactElement } from \"react\";\r\n\r\nimport { formatDuration } from \"../../../DateUtils\";\r\nimport { _t } from \"../../../languageHandler\";\r\nimport Dropdown from \"../elements/Dropdown\";\r\nimport { type NonEmptyArray } from \"../../../@types/common\";\r\n\r\nconst DURATION_MS = {\r\n    fifteenMins: 900000,\r\n    oneHour: 3600000,\r\n    eightHours: 28800000,\r\n};\r\n\r\nexport const DEFAULT_DURATION_MS = DURATION_MS.fifteenMins;\r\n\r\ninterface Props {\r\n    timeout: number;\r\n    onChange: (timeout: number) => void;\r\n}\r\n\r\nconst getLabel = (durationMs: number): string => {\r\n    return _t(\"location_sharing|live_share_button\", { duration: formatDuration(durationMs) });\r\n};\r\n\r\nconst LiveDurationDropdown: React.FC<Props> = ({ timeout, onChange }) => {\r\n    const options = Object.values(DURATION_MS).map((duration) => ({\r\n        key: duration.toString(),\r\n        duration,\r\n        label: getLabel(duration),\r\n    }));\r\n\r\n    // timeout is not one of our default values\r\n    // eg it was set by another client\r\n    if (!Object.values(DURATION_MS).includes(timeout)) {\r\n        options.push({\r\n            key: timeout.toString(),\r\n            duration: timeout,\r\n            label: getLabel(timeout),\r\n        });\r\n    }\r\n\r\n    const onOptionChange = (key: string): void => {\r\n        // stringified value back to number\r\n        onChange(+key);\r\n    };\r\n\r\n    return (\r\n        <Dropdown\r\n            id=\"live-duration\"\r\n            data-testid=\"live-duration-dropdown\"\r\n            label={getLabel(timeout)}\r\n            value={timeout.toString()}\r\n            onOptionChange={onOptionChange}\r\n            className=\"mx_LiveDurationDropdown\"\r\n        >\r\n            {\r\n                options.map(({ key, label }) => (\r\n                    <div data-testid={`live-duration-option-${key}`} key={key}>\r\n                        {label}\r\n                    </div>\r\n                )) as NonEmptyArray<ReactElement & { key: string }>\r\n            }\r\n        </Dropdown>\r\n    );\r\n};\r\n\r\nexport default LiveDurationDropdown;\r\n","/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2022 The Matrix.org Foundation C.I.C.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport {\r\n    type MatrixClient,\r\n    type IEventRelation,\r\n    type MatrixError,\r\n    THREAD_RELATION_TYPE,\r\n    ContentHelpers,\r\n    LocationAssetType,\r\n} from \"matrix-js-sdk/src/matrix\";\r\nimport { type RoomMessageEventContent } from \"matrix-js-sdk/src/types\";\r\nimport { logger } from \"matrix-js-sdk/src/logger\";\r\n\r\nimport { _t } from \"../../../languageHandler\";\r\nimport Modal from \"../../../Modal\";\r\nimport QuestionDialog, { type IQuestionDialogProps } from \"../dialogs/QuestionDialog\";\r\nimport SdkConfig from \"../../../SdkConfig\";\r\nimport { OwnBeaconStore } from \"../../../stores/OwnBeaconStore\";\r\nimport { doMaybeLocalRoomAction } from \"../../../utils/local-room\";\r\n\r\nexport enum LocationShareType {\r\n    Own = \"Own\",\r\n    Pin = \"Pin\",\r\n    Live = \"Live\",\r\n}\r\n\r\nexport type LocationShareProps = {\r\n    timeout?: number;\r\n    uri?: string;\r\n    timestamp?: number;\r\n};\r\n\r\n// default duration to 5min for now\r\nconst DEFAULT_LIVE_DURATION = 300000;\r\n\r\nexport type ShareLocationFn = (props: LocationShareProps) => Promise<void>;\r\n\r\nconst getPermissionsErrorParams = (\r\n    shareType: LocationShareType,\r\n): {\r\n    errorMessage: string;\r\n    modalParams: IQuestionDialogProps;\r\n} => {\r\n    const errorMessage =\r\n        shareType === LocationShareType.Live\r\n            ? \"Insufficient permissions to start sharing your live location\"\r\n            : \"Insufficient permissions to send your location\";\r\n\r\n    const modalParams = {\r\n        title: _t(\"location_sharing|error_no_perms_title\"),\r\n        description: _t(\"location_sharing|error_no_perms_description\"),\r\n        button: _t(\"action|ok\"),\r\n        hasCancelButton: false,\r\n        onFinished: () => {}, // NOOP\r\n    };\r\n    return { modalParams, errorMessage };\r\n};\r\n\r\nconst getDefaultErrorParams = (\r\n    shareType: LocationShareType,\r\n    openMenu: () => void,\r\n): {\r\n    errorMessage: string;\r\n    modalParams: IQuestionDialogProps;\r\n} => {\r\n    const errorMessage =\r\n        shareType === LocationShareType.Live\r\n            ? \"We couldn't start sharing your live location\"\r\n            : \"We couldn't send your location\";\r\n    const modalParams = {\r\n        title: _t(\"location_sharing|error_send_title\"),\r\n        description: _t(\"location_sharing|error_send_description\", {\r\n            brand: SdkConfig.get().brand,\r\n        }),\r\n        button: _t(\"action|try_again\"),\r\n        cancelButton: _t(\"action|cancel\"),\r\n        onFinished: (tryAgain: boolean) => {\r\n            if (tryAgain) {\r\n                openMenu();\r\n            }\r\n        },\r\n    };\r\n    return { modalParams, errorMessage };\r\n};\r\n\r\nconst handleShareError = (error: unknown, openMenu: () => void, shareType: LocationShareType): void => {\r\n    const { modalParams, errorMessage } =\r\n        (error as MatrixError).errcode === \"M_FORBIDDEN\"\r\n            ? getPermissionsErrorParams(shareType)\r\n            : getDefaultErrorParams(shareType, openMenu);\r\n\r\n    logger.error(errorMessage, error);\r\n\r\n    Modal.createDialog(QuestionDialog, modalParams);\r\n};\r\n\r\nexport const shareLiveLocation =\r\n    (client: MatrixClient, roomId: string, displayName: string, openMenu: () => void): ShareLocationFn =>\r\n    async ({ timeout }): Promise<void> => {\r\n        const description = _t(\"location_sharing|live_description\", { displayName });\r\n        try {\r\n            await OwnBeaconStore.instance.createLiveBeacon(\r\n                roomId,\r\n                ContentHelpers.makeBeaconInfoContent(\r\n                    timeout ?? DEFAULT_LIVE_DURATION,\r\n                    true /* isLive */,\r\n                    description,\r\n                    LocationAssetType.Self,\r\n                ),\r\n            );\r\n        } catch (error) {\r\n            handleShareError(error, openMenu, LocationShareType.Live);\r\n        }\r\n    };\r\n\r\nexport const shareLocation =\r\n    (\r\n        client: MatrixClient,\r\n        roomId: string,\r\n        shareType: LocationShareType,\r\n        relation: IEventRelation | undefined,\r\n        openMenu: () => void,\r\n    ): ShareLocationFn =>\r\n    async ({ uri, timestamp }): Promise<void> => {\r\n        if (!uri) return;\r\n        try {\r\n            const threadId = (relation?.rel_type === THREAD_RELATION_TYPE.name && relation?.event_id) || null;\r\n            const assetType = shareType === LocationShareType.Pin ? LocationAssetType.Pin : LocationAssetType.Self;\r\n            const content = ContentHelpers.makeLocationContent(\r\n                undefined,\r\n                uri,\r\n                timestamp,\r\n                undefined,\r\n                assetType,\r\n            ) as RoomMessageEventContent;\r\n            await doMaybeLocalRoomAction(\r\n                roomId,\r\n                (actualRoomId: string) => client.sendMessage(actualRoomId, threadId, content),\r\n                client,\r\n            );\r\n        } catch (error) {\r\n            handleShareError(error, openMenu, shareType);\r\n        }\r\n    };\r\n","/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2021 The Matrix.org Foundation C.I.C.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport React, { type SyntheticEvent } from \"react\";\r\nimport maplibregl, { type MapMouseEvent } from \"maplibre-gl\";\r\nimport { logger } from \"matrix-js-sdk/src/logger\";\r\nimport { type RoomMember, ClientEvent, type IClientWellKnown } from \"matrix-js-sdk/src/matrix\";\r\n\r\nimport { _t } from \"../../../languageHandler\";\r\nimport MatrixClientContext from \"../../../contexts/MatrixClientContext\";\r\nimport Modal from \"../../../Modal\";\r\nimport { tileServerFromWellKnown } from \"../../../utils/WellKnownUtils\";\r\nimport { type GenericPosition, genericPositionFromGeolocation, getGeoUri } from \"../../../utils/beacon\";\r\nimport { LocationShareError, findMapStyleUrl, positionFailureMessage } from \"../../../utils/location\";\r\nimport ErrorDialog from \"../dialogs/ErrorDialog\";\r\nimport AccessibleButton from \"../elements/AccessibleButton\";\r\nimport { MapError } from \"./MapError\";\r\nimport LiveDurationDropdown, { DEFAULT_DURATION_MS } from \"./LiveDurationDropdown\";\r\nimport { LocationShareType, type ShareLocationFn } from \"./shareLocation\";\r\nimport Marker from \"./Marker\";\r\n\r\nexport interface ILocationPickerProps {\r\n    sender: RoomMember;\r\n    shareType: LocationShareType;\r\n    onChoose: ShareLocationFn;\r\n    onFinished(ev?: SyntheticEvent): void;\r\n}\r\n\r\ninterface IState {\r\n    timeout: number;\r\n    position?: GenericPosition;\r\n    error?: LocationShareError;\r\n}\r\n\r\nconst isSharingOwnLocation = (shareType: LocationShareType): boolean =>\r\n    shareType === LocationShareType.Own || shareType === LocationShareType.Live;\r\n\r\nclass LocationPicker extends React.Component<ILocationPickerProps, IState> {\r\n    public static contextType = MatrixClientContext;\r\n    declare public context: React.ContextType<typeof MatrixClientContext>;\r\n    private map?: maplibregl.Map;\r\n    private geolocate?: maplibregl.GeolocateControl;\r\n    private marker?: maplibregl.Marker;\r\n\r\n    public constructor(props: ILocationPickerProps) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            position: undefined,\r\n            timeout: DEFAULT_DURATION_MS,\r\n            error: undefined,\r\n        };\r\n    }\r\n\r\n    private getMarkerId = (): string => {\r\n        return \"mx_MLocationPicker_marker\";\r\n    };\r\n\r\n    public componentDidMount(): void {\r\n        this.context.on(ClientEvent.ClientWellKnown, this.updateStyleUrl);\r\n\r\n        try {\r\n            this.map = new maplibregl.Map({\r\n                container: \"mx_LocationPicker_map\",\r\n                style: findMapStyleUrl(this.context),\r\n                center: [0, 0],\r\n                zoom: 1,\r\n            });\r\n\r\n            // Add geolocate control to the map.\r\n            this.geolocate = new maplibregl.GeolocateControl({\r\n                positionOptions: {\r\n                    enableHighAccuracy: true,\r\n                },\r\n                trackUserLocation: false,\r\n            });\r\n\r\n            this.map.addControl(this.geolocate);\r\n\r\n            this.map.on(\"error\", (e) => {\r\n                logger.error(\r\n                    \"Failed to load map: check map_style_url in config.json has a valid URL and API key\",\r\n                    e.error,\r\n                );\r\n                this.setState({ error: LocationShareError.MapStyleUrlNotReachable });\r\n            });\r\n\r\n            this.map.on(\"load\", () => {\r\n                this.geolocate?.trigger();\r\n            });\r\n\r\n            this.geolocate.on(\"error\", this.onGeolocateError);\r\n\r\n            if (isSharingOwnLocation(this.props.shareType)) {\r\n                this.geolocate.on(\"geolocate\", this.onGeolocate);\r\n            }\r\n\r\n            if (this.props.shareType === LocationShareType.Pin) {\r\n                const navigationControl = new maplibregl.NavigationControl({\r\n                    showCompass: false,\r\n                    showZoom: true,\r\n                });\r\n                this.map.addControl(navigationControl, \"bottom-right\");\r\n                this.map.on(\"click\", this.onClick);\r\n            }\r\n        } catch (e) {\r\n            logger.error(\"Failed to render map\", e);\r\n            const errorMessage = (e as Error)?.message;\r\n            let errorType;\r\n            if (errorMessage === LocationShareError.MapStyleUrlNotConfigured)\r\n                errorType = LocationShareError.MapStyleUrlNotConfigured;\r\n            else if (errorMessage.includes(\"Failed to initialize WebGL\"))\r\n                errorType = LocationShareError.WebGLNotEnabled;\r\n            else errorType = LocationShareError.Default;\r\n            this.setState({ error: errorType });\r\n        }\r\n    }\r\n\r\n    public componentWillUnmount(): void {\r\n        this.geolocate?.off(\"error\", this.onGeolocateError);\r\n        this.geolocate?.off(\"geolocate\", this.onGeolocate);\r\n        this.map?.off(\"click\", this.onClick);\r\n        this.context.off(ClientEvent.ClientWellKnown, this.updateStyleUrl);\r\n    }\r\n\r\n    private addMarkerToMap = (): void => {\r\n        this.marker = new maplibregl.Marker({\r\n            element: document.getElementById(this.getMarkerId()) ?? undefined,\r\n            anchor: \"bottom\",\r\n            offset: [0, -1],\r\n        })\r\n            .setLngLat(new maplibregl.LngLat(0, 0))\r\n            .addTo(this.map!);\r\n    };\r\n\r\n    private updateStyleUrl = (clientWellKnown: IClientWellKnown): void => {\r\n        const style = tileServerFromWellKnown(clientWellKnown)?.[\"map_style_url\"];\r\n        if (style) {\r\n            this.map?.setStyle(style);\r\n        }\r\n    };\r\n\r\n    private onGeolocate = (position: GeolocationPosition): void => {\r\n        if (!this.marker) {\r\n            this.addMarkerToMap();\r\n        }\r\n        this.setState({ position: genericPositionFromGeolocation(position) });\r\n        this.marker?.setLngLat(new maplibregl.LngLat(position.coords.longitude, position.coords.latitude));\r\n    };\r\n\r\n    private onClick = (event: MapMouseEvent): void => {\r\n        if (!this.marker) {\r\n            this.addMarkerToMap();\r\n        }\r\n        this.marker?.setLngLat(event.lngLat);\r\n        this.setState({\r\n            position: {\r\n                timestamp: Date.now(),\r\n                latitude: event.lngLat.lat,\r\n                longitude: event.lngLat.lng,\r\n            },\r\n        });\r\n    };\r\n\r\n    private onGeolocateError = (e: GeolocationPositionError): void => {\r\n        logger.error(\"Could not fetch location\", e);\r\n        // close the dialog and show an error when trying to share own location\r\n        // pin drop location without permissions is ok\r\n        if (isSharingOwnLocation(this.props.shareType)) {\r\n            this.props.onFinished();\r\n            Modal.createDialog(ErrorDialog, {\r\n                title: _t(\"location_sharing|error_fetch_location\"),\r\n                description: positionFailureMessage(e.code),\r\n            });\r\n        }\r\n\r\n        if (this.geolocate) {\r\n            this.map?.removeControl(this.geolocate);\r\n        }\r\n    };\r\n\r\n    private onTimeoutChange = (timeout: number): void => {\r\n        this.setState({ timeout });\r\n    };\r\n\r\n    private onOk = (): void => {\r\n        const { timeout, position } = this.state;\r\n\r\n        this.props.onChoose(\r\n            position\r\n                ? { uri: getGeoUri(position), timestamp: position.timestamp, timeout }\r\n                : {\r\n                      timeout,\r\n                  },\r\n        );\r\n        this.props.onFinished();\r\n    };\r\n\r\n    public render(): React.ReactNode {\r\n        if (this.state.error) {\r\n            return (\r\n                <div className=\"mx_LocationPicker mx_LocationPicker_hasError\">\r\n                    <MapError error={this.state.error} onFinished={this.props.onFinished} />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className=\"mx_LocationPicker\">\r\n                <div id=\"mx_LocationPicker_map\" />\r\n\r\n                {this.props.shareType === LocationShareType.Pin && (\r\n                    <div className=\"mx_LocationPicker_pinText\">\r\n                        <span>\r\n                            {this.state.position\r\n                                ? _t(\"location_sharing|click_move_pin\")\r\n                                : _t(\"location_sharing|click_drop_pin\")}\r\n                        </span>\r\n                    </div>\r\n                )}\r\n                <div className=\"mx_LocationPicker_footer\">\r\n                    <form onSubmit={this.onOk}>\r\n                        {this.props.shareType === LocationShareType.Live && (\r\n                            <LiveDurationDropdown onChange={this.onTimeoutChange} timeout={this.state.timeout} />\r\n                        )}\r\n                        <AccessibleButton\r\n                            data-testid=\"location-picker-submit-button\"\r\n                            type=\"submit\"\r\n                            element=\"button\"\r\n                            kind=\"primary\"\r\n                            className=\"mx_LocationPicker_submitButton\"\r\n                            disabled={!this.state.position}\r\n                            onClick={this.onOk}\r\n                        >\r\n                            {_t(\"location_sharing|share_button\")}\r\n                        </AccessibleButton>\r\n                    </form>\r\n                </div>\r\n                <div id={this.getMarkerId()}>\r\n                    {/*\r\n                    maplibregl hijacks the div above to style the marker\r\n                    it must be in the dom when the map is initialised\r\n                    and keep a consistent class\r\n                    we want to hide the marker until it is set in the case of pin drop\r\n                    so hide the internal visible elements\r\n                    */}\r\n\r\n                    {!!this.marker && (\r\n                        <Marker\r\n                            roomMember={isSharingOwnLocation(this.props.shareType) ? this.props.sender : undefined}\r\n                            useMemberColor={this.props.shareType === LocationShareType.Live}\r\n                        />\r\n                    )}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LocationPicker;\r\n","/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2022 The Matrix.org Foundation C.I.C.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport React from \"react\";\r\nimport CloseIcon from \"@vector-im/compound-design-tokens/assets/web/icons/close\";\r\nimport BackIcon from \"@vector-im/compound-design-tokens/assets/web/icons/chevron-left\";\r\n\r\nimport AccessibleButton from \"../elements/AccessibleButton\";\r\nimport { _t } from \"../../../languageHandler\";\r\n\r\ninterface Props {\r\n    onCancel: () => void;\r\n    onBack: () => void;\r\n    displayBack?: boolean;\r\n}\r\n\r\nconst ShareDialogButtons: React.FC<Props> = ({ onBack, onCancel, displayBack }) => {\r\n    return (\r\n        <div className=\"mx_ShareDialogButtons\">\r\n            {displayBack && (\r\n                <AccessibleButton\r\n                    className=\"mx_ShareDialogButtons_button left\"\r\n                    data-testid=\"share-dialog-buttons-back\"\r\n                    aria-label={_t(\"action|back\")}\r\n                    onClick={onBack}\r\n                    element=\"button\"\r\n                >\r\n                    <BackIcon className=\"mx_ShareDialogButtons_button-icon\" />\r\n                </AccessibleButton>\r\n            )}\r\n            <AccessibleButton\r\n                className=\"mx_ShareDialogButtons_button right\"\r\n                data-testid=\"share-dialog-buttons-cancel\"\r\n                aria-label={_t(\"action|close\")}\r\n                onClick={onCancel}\r\n                element=\"button\"\r\n            >\r\n                <CloseIcon className=\"mx_ShareDialogButtons_button-icon\" />\r\n            </AccessibleButton>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ShareDialogButtons;\r\n","/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2022 The Matrix.org Foundation C.I.C.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport React, { type HTMLAttributes, useContext } from \"react\";\r\nimport LocationIcon from \"@vector-im/compound-design-tokens/assets/web/icons/location-pin-solid\";\r\n\r\nimport MatrixClientContext from \"../../../contexts/MatrixClientContext\";\r\nimport { _t } from \"../../../languageHandler\";\r\nimport { OwnProfileStore } from \"../../../stores/OwnProfileStore\";\r\nimport BaseAvatar from \"../avatars/BaseAvatar\";\r\nimport AccessibleButton, { type ButtonEvent } from \"../elements/AccessibleButton\";\r\nimport Heading from \"../typography/Heading\";\r\nimport { LocationShareType } from \"./shareLocation\";\r\nimport StyledLiveBeaconIcon from \"../beacon/StyledLiveBeaconIcon\";\r\n\r\nconst UserAvatar: React.FC = () => {\r\n    const matrixClient = useContext(MatrixClientContext);\r\n    const userId = matrixClient.getSafeUserId();\r\n    const displayName = OwnProfileStore.instance.displayName ?? undefined;\r\n    // 40 - 2px border\r\n    const avatarSize = \"36px\";\r\n    const avatarUrl = OwnProfileStore.instance.getHttpAvatarUrl(parseInt(avatarSize, 10)) ?? undefined;\r\n\r\n    return (\r\n        <div className={`mx_ShareType_option-icon ${LocationShareType.Own}`}>\r\n            <BaseAvatar\r\n                idName={userId}\r\n                name={displayName}\r\n                url={avatarUrl}\r\n                size={avatarSize}\r\n                className=\"mx_UserMenu_userAvatar_BaseAvatar\"\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\ntype ShareTypeOptionProps = HTMLAttributes<Element> & {\r\n    label: string;\r\n    shareType: LocationShareType;\r\n    onClick?: ((e: ButtonEvent) => void | Promise<void>) | null;\r\n};\r\nconst ShareTypeOption: React.FC<ShareTypeOptionProps> = ({ onClick, label, shareType, ...rest }) => (\r\n    <AccessibleButton element=\"button\" className=\"mx_ShareType_option\" onClick={onClick ?? null} {...rest}>\r\n        {shareType === LocationShareType.Own && <UserAvatar />}\r\n        {shareType === LocationShareType.Pin && (\r\n            <LocationIcon className={`mx_ShareType_option-icon ${LocationShareType.Pin}`} />\r\n        )}\r\n        {shareType === LocationShareType.Live && (\r\n            <StyledLiveBeaconIcon className={`mx_ShareType_option-icon ${LocationShareType.Live}`} />\r\n        )}\r\n\r\n        {label}\r\n    </AccessibleButton>\r\n);\r\n\r\ninterface Props {\r\n    setShareType: (shareType: LocationShareType) => void;\r\n    enabledShareTypes: LocationShareType[];\r\n}\r\nconst ShareType: React.FC<Props> = ({ setShareType, enabledShareTypes }) => {\r\n    const labels = {\r\n        [LocationShareType.Own]: _t(\"location_sharing|share_type_own\"),\r\n        [LocationShareType.Live]: _t(\"location_sharing|share_type_live\"),\r\n        [LocationShareType.Pin]: _t(\"location_sharing|share_type_pin\"),\r\n    };\r\n    return (\r\n        <div className=\"mx_ShareType\">\r\n            <LocationIcon className=\"mx_ShareType_badge\" />\r\n            <Heading className=\"mx_ShareType_heading\" size=\"3\">\r\n                {_t(\"location_sharing|share_type_prompt\")}\r\n            </Heading>\r\n            <div className=\"mx_ShareType_wrapper_options\">\r\n                {enabledShareTypes.map((type) => (\r\n                    <ShareTypeOption\r\n                        key={type}\r\n                        onClick={() => setShareType(type)}\r\n                        label={labels[type]}\r\n                        shareType={type}\r\n                        data-testid={`share-location-option-${type}`}\r\n                    />\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ShareType;\r\n","/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2022 The Matrix.org Foundation C.I.C.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport React, { useState } from \"react\";\r\n\r\nimport { _t } from \"../../../languageHandler\";\r\nimport StyledLiveBeaconIcon from \"../beacon/StyledLiveBeaconIcon\";\r\nimport AccessibleButton from \"../elements/AccessibleButton\";\r\nimport LabelledToggleSwitch from \"../elements/LabelledToggleSwitch\";\r\nimport Heading from \"../typography/Heading\";\r\n\r\ninterface Props {\r\n    onSubmit: () => void;\r\n}\r\n\r\nexport const EnableLiveShare: React.FC<Props> = ({ onSubmit }) => {\r\n    const [isEnabled, setEnabled] = useState(false);\r\n    return (\r\n        <div data-testid=\"location-picker-enable-live-share\" className=\"mx_EnableLiveShare\">\r\n            <StyledLiveBeaconIcon className=\"mx_EnableLiveShare_icon\" />\r\n            <Heading className=\"mx_EnableLiveShare_heading\" size=\"3\">\r\n                {_t(\"location_sharing|live_enable_heading\")}\r\n            </Heading>\r\n            <p className=\"mx_EnableLiveShare_description\">{_t(\"location_sharing|live_enable_description\")}</p>\r\n            <LabelledToggleSwitch\r\n                data-testid=\"enable-live-share-toggle\"\r\n                value={isEnabled}\r\n                onChange={setEnabled}\r\n                label={_t(\"location_sharing|live_toggle_label\")}\r\n            />\r\n            <AccessibleButton\r\n                data-testid=\"enable-live-share-submit\"\r\n                className=\"mx_EnableLiveShare_button\"\r\n                element=\"button\"\r\n                kind=\"primary\"\r\n                onClick={onSubmit}\r\n                disabled={!isEnabled}\r\n            >\r\n                {_t(\"action|ok\")}\r\n            </AccessibleButton>\r\n        </div>\r\n    );\r\n};\r\n","/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2022 The Matrix.org Foundation C.I.C.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport React, { type SyntheticEvent, useContext, useState } from \"react\";\r\nimport { type Room, type IEventRelation } from \"matrix-js-sdk/src/matrix\";\r\n\r\nimport MatrixClientContext from \"../../../contexts/MatrixClientContext\";\r\nimport ContextMenu, { type MenuProps } from \"../../structures/ContextMenu\";\r\nimport LocationPicker, { type ILocationPickerProps } from \"./LocationPicker\";\r\nimport { shareLiveLocation, shareLocation, LocationShareType } from \"./shareLocation\";\r\nimport SettingsStore from \"../../../settings/SettingsStore\";\r\nimport ShareDialogButtons from \"./ShareDialogButtons\";\r\nimport ShareType from \"./ShareType\";\r\nimport { OwnProfileStore } from \"../../../stores/OwnProfileStore\";\r\nimport { EnableLiveShare } from \"./EnableLiveShare\";\r\nimport { useFeatureEnabled } from \"../../../hooks/useSettings\";\r\nimport { SettingLevel } from \"../../../settings/SettingLevel\";\r\n\r\ntype Props = Omit<ILocationPickerProps, \"onChoose\" | \"shareType\"> & {\r\n    onFinished: (ev?: SyntheticEvent) => void;\r\n    menuPosition: MenuProps;\r\n    openMenu: () => void;\r\n    roomId: Room[\"roomId\"];\r\n    relation?: IEventRelation;\r\n};\r\n\r\nconst getEnabledShareTypes = (relation?: IEventRelation): LocationShareType[] => {\r\n    const enabledShareTypes = [LocationShareType.Own];\r\n\r\n    // live locations cannot have a relation\r\n    // hide the option when composer has a relation\r\n    if (!relation) {\r\n        enabledShareTypes.push(LocationShareType.Live);\r\n    }\r\n\r\n    enabledShareTypes.push(LocationShareType.Pin);\r\n\r\n    return enabledShareTypes;\r\n};\r\n\r\nconst LocationShareMenu: React.FC<Props> = ({ menuPosition, onFinished, sender, roomId, openMenu, relation }) => {\r\n    const matrixClient = useContext(MatrixClientContext);\r\n    const enabledShareTypes = getEnabledShareTypes(relation);\r\n    const isLiveShareEnabled = useFeatureEnabled(\"feature_location_share_live\");\r\n\r\n    const multipleShareTypesEnabled = enabledShareTypes.length > 1;\r\n\r\n    const [shareType, setShareType] = useState<LocationShareType | undefined>(\r\n        multipleShareTypesEnabled ? undefined : LocationShareType.Own,\r\n    );\r\n\r\n    const displayName = OwnProfileStore.instance.displayName;\r\n    const userId = matrixClient.getSafeUserId();\r\n\r\n    const onLocationSubmit =\r\n        shareType === LocationShareType.Live\r\n            ? shareLiveLocation(matrixClient, roomId, displayName || userId, openMenu)\r\n            : shareLocation(matrixClient, roomId, shareType ?? LocationShareType.Own, relation, openMenu);\r\n\r\n    const onLiveShareEnableSubmit = (): void => {\r\n        SettingsStore.setValue(\"feature_location_share_live\", null, SettingLevel.DEVICE, true);\r\n    };\r\n\r\n    const shouldAdvertiseLiveLabsFlag = shareType === LocationShareType.Live && !isLiveShareEnabled;\r\n\r\n    return (\r\n        <ContextMenu {...menuPosition} onFinished={onFinished} managed={false}>\r\n            <div className=\"mx_LocationShareMenu\">\r\n                {shouldAdvertiseLiveLabsFlag && <EnableLiveShare onSubmit={onLiveShareEnableSubmit} />}\r\n                {!shouldAdvertiseLiveLabsFlag && !!shareType && (\r\n                    <LocationPicker\r\n                        sender={sender}\r\n                        shareType={shareType}\r\n                        onChoose={onLocationSubmit}\r\n                        onFinished={onFinished}\r\n                    />\r\n                )}\r\n                {!shareType && <ShareType setShareType={setShareType} enabledShareTypes={enabledShareTypes} />}\r\n                <ShareDialogButtons\r\n                    displayBack={!!shareType && multipleShareTypesEnabled}\r\n                    onBack={() => setShareType(undefined)}\r\n                    onCancel={onFinished}\r\n                />\r\n            </div>\r\n        </ContextMenu>\r\n    );\r\n};\r\n\r\nexport default LocationShareMenu;\r\n","/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2021 The Matrix.org Foundation C.I.C.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport React, { type ReactNode, type SyntheticEvent, useContext } from \"react\";\r\nimport classNames from \"classnames\";\r\nimport { type RoomMember, type IEventRelation } from \"matrix-js-sdk/src/matrix\";\r\n\r\nimport { _t } from \"../../../languageHandler\";\r\nimport { CollapsibleButton } from \"../rooms/CollapsibleButton\";\r\nimport { aboveLeftOf, useContextMenu, type MenuProps } from \"../../structures/ContextMenu\";\r\nimport { OverflowMenuContext } from \"../rooms/MessageComposerButtons\";\r\nimport LocationShareMenu from \"./LocationShareMenu\";\r\n\r\nexport interface IProps {\r\n    roomId: string;\r\n    sender: RoomMember;\r\n    menuPosition?: MenuProps;\r\n    relation?: IEventRelation;\r\n}\r\n\r\nconst LocationButton: React.FC<IProps> = ({ roomId, sender, menuPosition, relation }) => {\r\n    const overflowMenuCloser = useContext(OverflowMenuContext);\r\n    const [menuDisplayed, button, openMenu, closeMenu] = useContextMenu();\r\n\r\n    const _onFinished = (ev?: SyntheticEvent): void => {\r\n        closeMenu(ev);\r\n        overflowMenuCloser?.();\r\n    };\r\n\r\n    let contextMenu: ReactNode = null;\r\n    if (menuDisplayed) {\r\n        const position = menuPosition ?? (button.current && aboveLeftOf(button.current.getBoundingClientRect())) ?? {};\r\n\r\n        contextMenu = (\r\n            <LocationShareMenu\r\n                menuPosition={position}\r\n                onFinished={_onFinished}\r\n                sender={sender}\r\n                roomId={roomId}\r\n                openMenu={openMenu}\r\n                relation={relation}\r\n            />\r\n        );\r\n    }\r\n\r\n    const className = classNames(\"mx_MessageComposer_button\", {\r\n        mx_MessageComposer_button_highlight: menuDisplayed,\r\n    });\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <CollapsibleButton\r\n                className={className}\r\n                iconClassName=\"mx_MessageComposer_location\"\r\n                onClick={openMenu}\r\n                title={_t(\"common|location\")}\r\n                inputRef={button}\r\n            />\r\n\r\n            {contextMenu}\r\n        </React.Fragment>\r\n    );\r\n};\r\n\r\nexport default LocationButton;\r\n","/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2022 The Matrix.org Foundation C.I.C.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport React, { type JSX, type ReactNode, type Ref, useState } from \"react\";\r\nimport classNames from \"classnames\";\r\nimport { type RoomMember } from \"matrix-js-sdk/src/matrix\";\r\nimport LocationIcon from \"@vector-im/compound-design-tokens/assets/web/icons/location-pin-solid\";\r\n\r\nimport { getUserNameColorClass } from \"../../../utils/FormattingUtils\";\r\nimport MemberAvatar from \"../avatars/MemberAvatar\";\r\n\r\ninterface Props {\r\n    id?: string;\r\n    // renders MemberAvatar when provided\r\n    roomMember?: RoomMember;\r\n    // use member text color as background\r\n    useMemberColor?: boolean;\r\n    tooltip?: ReactNode;\r\n    ref?: Ref<HTMLDivElement>;\r\n}\r\n\r\n/**\r\n * Wrap with tooltip handlers when\r\n * tooltip is truthy\r\n */\r\nconst OptionalTooltip: React.FC<{\r\n    tooltip?: ReactNode;\r\n    children: ReactNode;\r\n}> = ({ tooltip, children }) => {\r\n    const [isVisible, setIsVisible] = useState(false);\r\n    if (!tooltip) {\r\n        return <>{children}</>;\r\n    }\r\n\r\n    const show = (): void => setIsVisible(true);\r\n    const hide = (): void => setIsVisible(false);\r\n    const toggleVisibility = (e: React.MouseEvent<HTMLDivElement, MouseEvent>): void => {\r\n        // stop map from zooming in on click\r\n        e.stopPropagation();\r\n        setIsVisible(!isVisible);\r\n    };\r\n\r\n    return (\r\n        <div onMouseEnter={show} onClick={toggleVisibility} onMouseLeave={hide}>\r\n            {children}\r\n            {isVisible && tooltip}\r\n        </div>\r\n    );\r\n};\r\n\r\n/**\r\n * Generic location marker\r\n */\r\nconst Marker = ({ id, roomMember, useMemberColor, tooltip, ref }: Props): JSX.Element => {\r\n    const memberColorClass = useMemberColor && roomMember ? getUserNameColorClass(roomMember.userId) : \"\";\r\n    return (\r\n        <div\r\n            ref={ref}\r\n            id={id}\r\n            className={classNames(\"mx_Marker\", memberColorClass, {\r\n                mx_Marker_defaultColor: !memberColorClass,\r\n            })}\r\n        >\r\n            <OptionalTooltip tooltip={tooltip}>\r\n                <div className=\"mx_Marker_border\">\r\n                    {roomMember ? (\r\n                        <MemberAvatar\r\n                            member={roomMember}\r\n                            size=\"36px\"\r\n                            viewUserOnClick={false}\r\n                            // no mxid on hover when marker has tooltip\r\n                            hideTitle={!!tooltip}\r\n                        />\r\n                    ) : (\r\n                        <LocationIcon className=\"mx_Marker_icon\" />\r\n                    )}\r\n                </div>\r\n            </OptionalTooltip>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Marker;\r\n","/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2021 The Matrix.org Foundation C.I.C.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport React, { type RefObject, useContext } from \"react\";\r\nimport classNames from \"classnames\";\r\n\r\nimport AccessibleButton, { type ButtonProps } from \"../elements/AccessibleButton\";\r\nimport { OverflowMenuContext } from \"./MessageComposerButtons\";\r\nimport { IconizedContextMenuOption } from \"../context_menus/IconizedContextMenu\";\r\n\r\ninterface Props extends Omit<ButtonProps<\"div\">, \"element\"> {\r\n    inputRef?: RefObject<HTMLElement | null>;\r\n    title: string;\r\n    iconClassName: string;\r\n}\r\n\r\nexport const CollapsibleButton: React.FC<Props> = ({\r\n    title,\r\n    children,\r\n    className,\r\n    iconClassName,\r\n    inputRef,\r\n    ...props\r\n}) => {\r\n    const inOverflowMenu = !!useContext(OverflowMenuContext);\r\n    if (inOverflowMenu) {\r\n        return <IconizedContextMenuOption {...props} iconClassName={iconClassName} label={title} inputRef={inputRef} />;\r\n    }\r\n\r\n    return (\r\n        <AccessibleButton {...props} title={title} className={classNames(className, iconClassName)} ref={inputRef}>\r\n            {children}\r\n        </AccessibleButton>\r\n    );\r\n};\r\n","/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2022 The Matrix.org Foundation C.I.C.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport classNames from \"classnames\";\r\nimport React, { type JSX, useContext } from \"react\";\r\n\r\nimport { _t } from \"../../../languageHandler\";\r\nimport ContextMenu, { aboveLeftOf, type MenuProps, useContextMenu } from \"../../structures/ContextMenu\";\r\nimport EmojiPicker from \"../emojipicker/EmojiPicker\";\r\nimport { CollapsibleButton } from \"./CollapsibleButton\";\r\nimport { OverflowMenuContext } from \"./MessageComposerButtons\";\r\n\r\ninterface IEmojiButtonProps {\r\n    addEmoji: (unicode: string) => boolean;\r\n    menuPosition?: MenuProps;\r\n    className?: string;\r\n}\r\n\r\nexport function EmojiButton({ addEmoji, menuPosition, className }: IEmojiButtonProps): JSX.Element {\r\n    const overflowMenuCloser = useContext(OverflowMenuContext);\r\n    const [menuDisplayed, button, openMenu, closeMenu] = useContextMenu();\r\n\r\n    let contextMenu: React.ReactElement | null = null;\r\n    if (menuDisplayed && button.current) {\r\n        const position = menuPosition ?? aboveLeftOf(button.current.getBoundingClientRect());\r\n        const onFinished = (): void => {\r\n            closeMenu();\r\n            overflowMenuCloser?.();\r\n        };\r\n\r\n        contextMenu = (\r\n            <ContextMenu {...position} onFinished={onFinished} managed={false}>\r\n                <EmojiPicker onChoose={addEmoji} onFinished={onFinished} />\r\n            </ContextMenu>\r\n        );\r\n    }\r\n\r\n    const computedClassName = classNames(\"mx_EmojiButton\", className, {\r\n        mx_EmojiButton_highlight: menuDisplayed,\r\n    });\r\n\r\n    // TODO: replace ContextMenuTooltipButton with a unified representation of\r\n    // the header buttons and the right panel buttons\r\n    return (\r\n        <>\r\n            <CollapsibleButton\r\n                className={computedClassName}\r\n                iconClassName=\"mx_EmojiButton_icon\"\r\n                onClick={openMenu}\r\n                title={_t(\"common|emoji\")}\r\n                inputRef={button}\r\n            />\r\n\r\n            {contextMenu}\r\n        </>\r\n    );\r\n}\r\n","/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2022 The Matrix.org Foundation C.I.C.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n*/\r\n\r\nimport classNames from \"classnames\";\r\nimport {\r\n    type IEventRelation,\r\n    type Room,\r\n    type MatrixClient,\r\n    THREAD_RELATION_TYPE,\r\n    M_POLL_START,\r\n} from \"matrix-js-sdk/src/matrix\";\r\nimport React, { type JSX, createContext, type ReactElement, type ReactNode, useContext, useRef } from \"react\";\r\n\r\nimport { _t } from \"../../../languageHandler\";\r\nimport { CollapsibleButton } from \"./CollapsibleButton\";\r\nimport { type MenuProps } from \"../../structures/ContextMenu\";\r\nimport dis from \"../../../dispatcher/dispatcher\";\r\nimport ErrorDialog from \"../dialogs/ErrorDialog\";\r\nimport { LocationButton } from \"../location\";\r\nimport Modal from \"../../../Modal\";\r\nimport PollCreateDialog from \"../elements/PollCreateDialog\";\r\nimport { MatrixClientPeg } from \"../../../MatrixClientPeg\";\r\nimport ContentMessages from \"../../../ContentMessages\";\r\nimport MatrixClientContext from \"../../../contexts/MatrixClientContext\";\r\nimport { useDispatcher } from \"../../../hooks/useDispatcher\";\r\nimport { chromeFileInputFix } from \"../../../utils/BrowserWorkarounds\";\r\nimport IconizedContextMenu, { IconizedContextMenuOptionList } from \"../context_menus/IconizedContextMenu\";\r\nimport { EmojiButton } from \"./EmojiButton\";\r\nimport { filterBoolean } from \"../../../utils/arrays\";\r\nimport { useSettingValue } from \"../../../hooks/useSettings\";\r\nimport AccessibleButton, { type ButtonEvent } from \"../elements/AccessibleButton\";\r\nimport { useScopedRoomContext } from \"../../../contexts/ScopedRoomContext.tsx\";\r\n\r\ninterface IProps {\r\n    addEmoji: (emoji: string) => boolean;\r\n    haveRecording: boolean;\r\n    isMenuOpen: boolean;\r\n    isStickerPickerOpen: boolean;\r\n    menuPosition?: MenuProps;\r\n    onRecordStartEndClick: () => void;\r\n    relation?: IEventRelation;\r\n    setStickerPickerOpen: (isStickerPickerOpen: boolean) => void;\r\n    showLocationButton: boolean;\r\n    showPollsButton: boolean;\r\n    showStickersButton: boolean;\r\n    toggleButtonMenu: () => void;\r\n    isRichTextEnabled: boolean;\r\n    onComposerModeClick: () => void;\r\n}\r\n\r\ntype OverflowMenuCloser = () => void;\r\nexport const OverflowMenuContext = createContext<OverflowMenuCloser | null>(null);\r\n\r\nconst MessageComposerButtons: React.FC<IProps> = (props: IProps) => {\r\n    const matrixClient = useContext(MatrixClientContext);\r\n    const { room, narrow } = useScopedRoomContext(\"room\", \"narrow\");\r\n\r\n    const isWysiwygLabEnabled = useSettingValue(\"feature_wysiwyg_composer\");\r\n\r\n    if (!matrixClient || !room || props.haveRecording) {\r\n        return null;\r\n    }\r\n\r\n    let mainButtons: ReactNode[];\r\n    let moreButtons: ReactNode[];\r\n    if (narrow) {\r\n        mainButtons = [\r\n            isWysiwygLabEnabled ? (\r\n                <ComposerModeButton\r\n                    key=\"composerModeButton\"\r\n                    isRichTextEnabled={props.isRichTextEnabled}\r\n                    onClick={props.onComposerModeClick}\r\n                />\r\n            ) : (\r\n                emojiButton(props)\r\n            ),\r\n        ];\r\n        moreButtons = [\r\n            uploadButton(), // props passed via UploadButtonContext\r\n            showStickersButton(props),\r\n            voiceRecordingButton(props, narrow),\r\n            props.showPollsButton ? pollButton(room, props.relation) : null,\r\n            showLocationButton(props, room, matrixClient),\r\n        ];\r\n    } else {\r\n        mainButtons = [\r\n            isWysiwygLabEnabled ? (\r\n                <ComposerModeButton\r\n                    key=\"composerModeButton\"\r\n                    isRichTextEnabled={props.isRichTextEnabled}\r\n                    onClick={props.onComposerModeClick}\r\n                />\r\n            ) : (\r\n                emojiButton(props)\r\n            ),\r\n            uploadButton(), // props passed via UploadButtonContext\r\n        ];\r\n        moreButtons = [\r\n            showStickersButton(props),\r\n            voiceRecordingButton(props, narrow),\r\n            props.showPollsButton ? pollButton(room, props.relation) : null,\r\n            showLocationButton(props, room, matrixClient),\r\n        ];\r\n    }\r\n\r\n    mainButtons = filterBoolean(mainButtons);\r\n    moreButtons = filterBoolean(moreButtons);\r\n\r\n    const moreOptionsClasses = classNames({\r\n        mx_MessageComposer_button: true,\r\n        mx_MessageComposer_buttonMenu: true,\r\n        mx_MessageComposer_closeButtonMenu: props.isMenuOpen,\r\n    });\r\n\r\n    return (\r\n        <UploadButtonContextProvider roomId={room.roomId} relation={props.relation}>\r\n            {mainButtons}\r\n            {moreButtons.length > 0 && (\r\n                <AccessibleButton\r\n                    className={moreOptionsClasses}\r\n                    onClick={props.toggleButtonMenu}\r\n                    title={_t(\"quick_settings|sidebar_settings\")}\r\n                />\r\n            )}\r\n            {props.isMenuOpen && (\r\n                <IconizedContextMenu\r\n                    onFinished={props.toggleButtonMenu}\r\n                    {...props.menuPosition}\r\n                    wrapperClassName=\"mx_MessageComposer_Menu\"\r\n                    compact={true}\r\n                >\r\n                    <OverflowMenuContext.Provider value={props.toggleButtonMenu}>\r\n                        <IconizedContextMenuOptionList>{moreButtons}</IconizedContextMenuOptionList>\r\n                    </OverflowMenuContext.Provider>\r\n                </IconizedContextMenu>\r\n            )}\r\n        </UploadButtonContextProvider>\r\n    );\r\n};\r\n\r\nfunction emojiButton(props: IProps): ReactElement {\r\n    return (\r\n        <EmojiButton\r\n            key=\"emoji_button\"\r\n            addEmoji={props.addEmoji}\r\n            menuPosition={props.menuPosition}\r\n            className=\"mx_MessageComposer_button\"\r\n        />\r\n    );\r\n}\r\n\r\nfunction uploadButton(): ReactElement {\r\n    return <UploadButton key=\"controls_upload\" />;\r\n}\r\n\r\ntype UploadButtonFn = () => void;\r\nexport const UploadButtonContext = createContext<UploadButtonFn | null>(null);\r\n\r\ninterface IUploadButtonProps {\r\n    roomId: string;\r\n    relation?: IEventRelation;\r\n    children: ReactNode;\r\n}\r\n\r\n// We put the file input outside the UploadButton component so that it doesn't get killed when the context menu closes.\r\nconst UploadButtonContextProvider: React.FC<IUploadButtonProps> = ({ roomId, relation, children }) => {\r\n    const cli = useContext(MatrixClientContext);\r\n    const roomContext = useScopedRoomContext(\"timelineRenderingType\");\r\n    const uploadInput = useRef<HTMLInputElement>(null);\r\n\r\n    const onUploadClick = (): void => {\r\n        if (cli?.isGuest()) {\r\n            dis.dispatch({ action: \"require_registration\" });\r\n            return;\r\n        }\r\n        uploadInput.current?.click();\r\n    };\r\n\r\n    useDispatcher(dis, (payload) => {\r\n        if (roomContext.timelineRenderingType === payload.context && payload.action === \"upload_file\") {\r\n            onUploadClick();\r\n        }\r\n    });\r\n\r\n    const onUploadFileInputChange = (ev: React.ChangeEvent<HTMLInputElement>): void => {\r\n        if (ev.target.files?.length === 0) return;\r\n\r\n        // Take a copy, so we can safely reset the value of the form control\r\n        ContentMessages.sharedInstance().sendContentListToRoom(\r\n            Array.from(ev.target.files!),\r\n            roomId,\r\n            relation,\r\n            cli,\r\n            roomContext.timelineRenderingType,\r\n        );\r\n\r\n        // This is the onChange handler for a file form control, but we're\r\n        // not keeping any state, so reset the value of the form control\r\n        // to empty.\r\n        // NB. we need to set 'value': the 'files' property is immutable.\r\n        ev.target.value = \"\";\r\n    };\r\n\r\n    const uploadInputStyle = { display: \"none\" };\r\n    return (\r\n        <UploadButtonContext.Provider value={onUploadClick}>\r\n            {children}\r\n\r\n            <input\r\n                ref={uploadInput}\r\n                type=\"file\"\r\n                style={uploadInputStyle}\r\n                multiple\r\n                onClick={chromeFileInputFix}\r\n                onChange={onUploadFileInputChange}\r\n            />\r\n        </UploadButtonContext.Provider>\r\n    );\r\n};\r\n\r\n// Must be rendered within an UploadButtonContextProvider\r\nconst UploadButton: React.FC = () => {\r\n    const overflowMenuCloser = useContext(OverflowMenuContext);\r\n    const uploadButtonFn = useContext(UploadButtonContext);\r\n\r\n    const onClick = (): void => {\r\n        uploadButtonFn?.();\r\n        overflowMenuCloser?.(); // close overflow menu\r\n    };\r\n\r\n    return (\r\n        <CollapsibleButton\r\n            className=\"mx_MessageComposer_button\"\r\n            iconClassName=\"mx_MessageComposer_upload\"\r\n            onClick={onClick}\r\n            title={_t(\"common|attachment\")}\r\n        />\r\n    );\r\n};\r\n\r\nfunction showStickersButton(props: IProps): ReactElement | null {\r\n    return props.showStickersButton ? (\r\n        <CollapsibleButton\r\n            id=\"stickersButton\"\r\n            key=\"controls_stickers\"\r\n            className=\"mx_MessageComposer_button\"\r\n            iconClassName=\"mx_MessageComposer_stickers\"\r\n            onClick={() => props.setStickerPickerOpen(!props.isStickerPickerOpen)}\r\n            title={props.isStickerPickerOpen ? _t(\"composer|close_sticker_picker\") : _t(\"common|sticker\")}\r\n        />\r\n    ) : null;\r\n}\r\n\r\nfunction voiceRecordingButton(props: IProps, narrow: boolean): ReactElement | null {\r\n    // XXX: recording UI does not work well in narrow mode, so hide for now\r\n    return narrow ? null : (\r\n        <CollapsibleButton\r\n            key=\"voice_message_send\"\r\n            className=\"mx_MessageComposer_button\"\r\n            iconClassName=\"mx_MessageComposer_voiceMessage\"\r\n            onClick={props.onRecordStartEndClick}\r\n            title={_t(\"composer|voice_message_button\")}\r\n        />\r\n    );\r\n}\r\n\r\nfunction pollButton(room: Room, relation?: IEventRelation): ReactElement {\r\n    return <PollButton key=\"polls\" room={room} relation={relation} />;\r\n}\r\n\r\ninterface IPollButtonProps {\r\n    room: Room;\r\n    relation?: IEventRelation;\r\n}\r\n\r\nclass PollButton extends React.PureComponent<IPollButtonProps> {\r\n    public static contextType = OverflowMenuContext;\r\n    declare public context: React.ContextType<typeof OverflowMenuContext>;\r\n\r\n    private onCreateClick = (): void => {\r\n        this.context?.(); // close overflow menu\r\n        const canSend = this.props.room.currentState.maySendEvent(\r\n            M_POLL_START.name,\r\n            MatrixClientPeg.safeGet().getSafeUserId(),\r\n        );\r\n        if (!canSend) {\r\n            Modal.createDialog(ErrorDialog, {\r\n                title: _t(\"composer|poll_button_no_perms_title\"),\r\n                description: _t(\"composer|poll_button_no_perms_description\"),\r\n            });\r\n        } else {\r\n            const threadId =\r\n                this.props.relation?.rel_type === THREAD_RELATION_TYPE.name ? this.props.relation.event_id : undefined;\r\n\r\n            Modal.createDialog(\r\n                PollCreateDialog,\r\n                {\r\n                    room: this.props.room,\r\n                    threadId,\r\n                },\r\n                \"mx_CompoundDialog\",\r\n                false, // isPriorityModal\r\n                true, // isStaticModal\r\n            );\r\n        }\r\n    };\r\n\r\n    public render(): React.ReactNode {\r\n        // do not allow sending polls within threads at this time\r\n        if (this.props.relation?.rel_type === THREAD_RELATION_TYPE.name) return null;\r\n\r\n        return (\r\n            <CollapsibleButton\r\n                className=\"mx_MessageComposer_button\"\r\n                iconClassName=\"mx_MessageComposer_poll\"\r\n                onClick={this.onCreateClick}\r\n                title={_t(\"composer|poll_button\")}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\nfunction showLocationButton(props: IProps, room: Room, matrixClient: MatrixClient): ReactElement | null {\r\n    const sender = room.getMember(matrixClient.getSafeUserId());\r\n\r\n    return props.showLocationButton && sender ? (\r\n        <LocationButton\r\n            key=\"location\"\r\n            roomId={room.roomId}\r\n            relation={props.relation}\r\n            sender={sender}\r\n            menuPosition={props.menuPosition}\r\n        />\r\n    ) : null;\r\n}\r\n\r\ninterface WysiwygToggleButtonProps {\r\n    isRichTextEnabled: boolean;\r\n    onClick: (ev: ButtonEvent) => void;\r\n}\r\n\r\nfunction ComposerModeButton({ isRichTextEnabled, onClick }: WysiwygToggleButtonProps): JSX.Element {\r\n    const title = isRichTextEnabled ? _t(\"composer|mode_plain\") : _t(\"composer|mode_rich_text\");\r\n\r\n    return (\r\n        <CollapsibleButton\r\n            className=\"mx_MessageComposer_button\"\r\n            iconClassName={classNames({\r\n                mx_MessageComposer_plain_text: !isRichTextEnabled,\r\n                mx_MessageComposer_rich_text: isRichTextEnabled,\r\n            })}\r\n            onClick={onClick}\r\n            title={title}\r\n        />\r\n    );\r\n}\r\n\r\nexport default MessageComposerButtons;\r\n"],"names":["DURATION_MS","fifteenMins","oneHour","eightHours","DEFAULT_DURATION_MS","getLabel","durationMs","_t","duration","formatDuration","LiveDurationDropdown","timeout","onChange","options","Object","values","map","key","toString","label","includes","push","React","Dropdown","id","value","onOptionChange","className","LocationShareType","handleShareError","error","openMenu","shareType","modalParams","errorMessage","errcode","Live","title","description","button","hasCancelButton","onFinished","getPermissionsErrorParams","getDefaultErrorParams","brand","SdkConfig","get","cancelButton","tryAgain","logger","Modal","createDialog","QuestionDialog","isSharingOwnLocation","Own","LocationPicker","constructor","props","super","_defineProperty","_document$getElementB","this","marker","maplibregl","element","document","getElementById","getMarkerId","undefined","anchor","offset","setLngLat","addTo","clientWellKnown","_tileServerFromWellKn","style","tileServerFromWellKnown","_this$map","setStyle","position","_this$marker","addMarkerToMap","setState","genericPositionFromGeolocation","coords","longitude","latitude","event","_this$marker2","lngLat","timestamp","Date","now","lat","lng","e","_this$map2","ErrorDialog","positionFailureMessage","code","geolocate","removeControl","state","onChoose","uri","getGeoUri","componentDidMount","context","on","ClientEvent","ClientWellKnown","updateStyleUrl","container","findMapStyleUrl","center","zoom","positionOptions","enableHighAccuracy","trackUserLocation","addControl","LocationShareError","MapStyleUrlNotReachable","_this$geolocate","trigger","onGeolocateError","onGeolocate","Pin","navigationControl","showCompass","showZoom","onClick","message","errorType","MapStyleUrlNotConfigured","WebGLNotEnabled","Default","componentWillUnmount","_this$geolocate2","_this$geolocate3","_this$map3","off","render","MapError","onSubmit","onOk","onTimeoutChange","AccessibleButton","type","kind","disabled","Marker","roomMember","sender","useMemberColor","MatrixClientContext","ShareDialogButtons","onBack","onCancel","displayBack","BackIcon","CloseIcon","UserAvatar","_OwnProfileStore$inst","_OwnProfileStore$inst2","userId","useContext","getSafeUserId","displayName","OwnProfileStore","instance","avatarSize","avatarUrl","getHttpAvatarUrl","parseInt","BaseAvatar","idName","name","url","size","ShareTypeOption","_ref","rest","_objectWithoutProperties","_excluded","_extends","LocationIcon","StyledLiveBeaconIcon","ShareType","setShareType","enabledShareTypes","labels","Heading","EnableLiveShare","isEnabled","setEnabled","useState","LabelledToggleSwitch","LocationShareMenu","menuPosition","roomId","relation","matrixClient","getEnabledShareTypes","isLiveShareEnabled","useFeatureEnabled","multipleShareTypesEnabled","length","onLocationSubmit","shareLiveLocation","client","async","OwnBeaconStore","createLiveBeacon","ContentHelpers","LocationAssetType","Self","shareLocation","threadId","rel_type","THREAD_RELATION_TYPE","event_id","assetType","content","doMaybeLocalRoomAction","actualRoomId","sendMessage","shouldAdvertiseLiveLabsFlag","ContextMenu","managed","onLiveShareEnableSubmit","SettingsStore","setValue","SettingLevel","DEVICE","LocationButton","overflowMenuCloser","OverflowMenuContext","menuDisplayed","closeMenu","useContextMenu","_onFinished","ev","contextMenu","current","aboveLeftOf","getBoundingClientRect","classNames","mx_MessageComposer_button_highlight","CollapsibleButton","iconClassName","inputRef","OptionalTooltip","tooltip","children","isVisible","setIsVisible","onMouseEnter","show","stopPropagation","onMouseLeave","hide","ref","memberColorClass","getUserNameColorClass","mx_Marker_defaultColor","MemberAvatar","member","viewUserOnClick","hideTitle","IconizedContextMenuOption","EmojiButton","addEmoji","EmojiPicker","computedClassName","mx_EmojiButton_highlight","createContext","emojiButton","uploadButton","UploadButton","UploadButtonContext","UploadButtonContextProvider","cli","roomContext","useScopedRoomContext","uploadInput","useRef","onUploadClick","_uploadInput$current","isGuest","dis","dispatch","action","click","useDispatcher","payload","timelineRenderingType","Provider","display","multiple","chromeFileInputFix","_ev$target$files","target","files","ContentMessages","sharedInstance","sendContentListToRoom","Array","from","uploadButtonFn","showStickersButton","setStickerPickerOpen","isStickerPickerOpen","voiceRecordingButton","narrow","onRecordStartEndClick","pollButton","room","PollButton","args","_this$context","call","currentState","maySendEvent","M_POLL_START","MatrixClientPeg","safeGet","_this$props$relation","PollCreateDialog","_this$props$relation2","onCreateClick","showLocationButton","getMember","ComposerModeButton","isRichTextEnabled","mx_MessageComposer_plain_text","mx_MessageComposer_rich_text","isWysiwygLabEnabled","useSettingValue","haveRecording","mainButtons","moreButtons","onComposerModeClick","showPollsButton","filterBoolean","moreOptionsClasses","mx_MessageComposer_button","mx_MessageComposer_buttonMenu","mx_MessageComposer_closeButtonMenu","isMenuOpen","toggleButtonMenu","IconizedContextMenu","wrapperClassName","compact","IconizedContextMenuOptionList"],"sourceRoot":""}