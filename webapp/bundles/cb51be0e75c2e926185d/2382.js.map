{"version":3,"file":"bundles/cb51be0e75c2e926185d/2382.js","mappings":"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","sources":["webpack://element-web/./src/effects/confetti/index.ts"],"sourcesContent":["/*\r\nCopyright 2024 New Vector Ltd.\r\nCopyright 2023 The Matrix.org Foundation C.I.C.\r\nCopyright 2020 Nurjin Jafar\r\nCopyright 2020 Nordeck IT + Consulting GmbH.\r\n\r\nSPDX-License-Identifier: AGPL-3.0-only OR GPL-3.0-only OR LicenseRef-Element-Commercial\r\nPlease see LICENSE files in the repository root for full details.\r\n */\r\nimport type ICanvasEffect from \"../ICanvasEffect\";\r\n\r\nexport type ConfettiOptions = {\r\n    /**\r\n     * max confetti count\r\n     */\r\n    maxCount: number;\r\n    /**\r\n     * particle animation speed\r\n     */\r\n    speed: number;\r\n    /**\r\n     * the confetti animation frame interval in milliseconds\r\n     */\r\n    frameInterval: number;\r\n    /**\r\n     * the alpha opacity of the confetti (between 0 and 1, where 1 is opaque and 0 is invisible)\r\n     */\r\n    alpha: number;\r\n    /**\r\n     * use gradient instead of solid particle color\r\n     */\r\n    gradient: boolean;\r\n};\r\n\r\ntype ConfettiParticle = {\r\n    color: string;\r\n    color2: string;\r\n    x: number;\r\n    y: number;\r\n    diameter: number;\r\n    tilt: number;\r\n    tiltAngleIncrement: number;\r\n    tiltAngle: number;\r\n};\r\n\r\nexport const DefaultOptions: ConfettiOptions = {\r\n    maxCount: 150,\r\n    speed: 3,\r\n    frameInterval: 15,\r\n    alpha: 1.0,\r\n    gradient: false,\r\n};\r\n\r\nexport default class Confetti implements ICanvasEffect {\r\n    private readonly options: ConfettiOptions;\r\n\r\n    public constructor(options: { [key: string]: any }) {\r\n        this.options = { ...DefaultOptions, ...options };\r\n    }\r\n\r\n    private context: CanvasRenderingContext2D | null = null;\r\n    private supportsAnimationFrame = window.requestAnimationFrame;\r\n    private colors = [\r\n        \"rgba(30,144,255,\",\r\n        \"rgba(107,142,35,\",\r\n        \"rgba(255,215,0,\",\r\n        \"rgba(255,192,203,\",\r\n        \"rgba(106,90,205,\",\r\n        \"rgba(173,216,230,\",\r\n        \"rgba(238,130,238,\",\r\n        \"rgba(152,251,152,\",\r\n        \"rgba(70,130,180,\",\r\n        \"rgba(244,164,96,\",\r\n        \"rgba(210,105,30,\",\r\n        \"rgba(220,20,60,\",\r\n    ];\r\n\r\n    private lastFrameTime = Date.now();\r\n    private particles: Array<ConfettiParticle> = [];\r\n    private waveAngle = 0;\r\n\r\n    public isRunning = false;\r\n\r\n    public start = async (canvas: HTMLCanvasElement, timeout = 3000): Promise<void> => {\r\n        if (!canvas) {\r\n            return;\r\n        }\r\n        this.context = canvas.getContext(\"2d\");\r\n        this.particles = [];\r\n        const count = this.options.maxCount;\r\n        while (this.particles.length < count) {\r\n            this.particles.push(this.resetParticle({} as ConfettiParticle, canvas.width, canvas.height));\r\n        }\r\n        this.isRunning = true;\r\n        this.runAnimation();\r\n        if (timeout) {\r\n            window.setTimeout(this.stop, timeout);\r\n        }\r\n    };\r\n\r\n    public stop = async (): Promise<void> => {\r\n        this.isRunning = false;\r\n    };\r\n\r\n    private resetParticle = (particle: ConfettiParticle, width: number, height: number): ConfettiParticle => {\r\n        particle.color = this.colors[(Math.random() * this.colors.length) | 0] + (this.options.alpha + \")\");\r\n        if (this.options.gradient) {\r\n            particle.color2 = this.colors[(Math.random() * this.colors.length) | 0] + (this.options.alpha + \")\");\r\n        } else {\r\n            particle.color2 = particle.color;\r\n        }\r\n        particle.x = Math.random() * width;\r\n        particle.y = Math.random() * -height;\r\n        particle.diameter = Math.random() * 10 + 5;\r\n        particle.tilt = Math.random() * -10;\r\n        particle.tiltAngleIncrement = Math.random() * 0.07 + 0.05;\r\n        particle.tiltAngle = Math.random() * Math.PI;\r\n        return particle;\r\n    };\r\n\r\n    private runAnimation = (): void => {\r\n        if (!this.context || !this.context.canvas) {\r\n            return;\r\n        }\r\n        if (this.particles.length === 0) {\r\n            this.context.clearRect(0, 0, this.context.canvas.width, this.context.canvas.height);\r\n        } else {\r\n            const now = Date.now();\r\n            const delta = now - this.lastFrameTime;\r\n            if (!this.supportsAnimationFrame || delta > this.options.frameInterval) {\r\n                this.context.clearRect(0, 0, this.context.canvas.width, this.context.canvas.height);\r\n                this.updateParticles();\r\n                this.drawParticles(this.context);\r\n                this.lastFrameTime = now - (delta % this.options.frameInterval);\r\n            }\r\n            requestAnimationFrame(this.runAnimation);\r\n        }\r\n    };\r\n\r\n    private drawParticles = (context: CanvasRenderingContext2D): void => {\r\n        if (!this.context || !this.context.canvas) {\r\n            return;\r\n        }\r\n        let x;\r\n        let x2;\r\n        let y2;\r\n        for (const particle of this.particles) {\r\n            this.context.beginPath();\r\n            context.lineWidth = particle.diameter;\r\n            x2 = particle.x + particle.tilt;\r\n            x = x2 + particle.diameter / 2;\r\n            y2 = particle.y + particle.tilt + particle.diameter / 2;\r\n            if (this.options.gradient) {\r\n                const gradient = context.createLinearGradient(x, particle.y, x2, y2);\r\n                gradient.addColorStop(0, particle.color);\r\n                gradient.addColorStop(1.0, particle.color2);\r\n                context.strokeStyle = gradient;\r\n            } else {\r\n                context.strokeStyle = particle.color;\r\n            }\r\n            context.moveTo(x, particle.y);\r\n            context.lineTo(x2, y2);\r\n            context.stroke();\r\n        }\r\n    };\r\n\r\n    private updateParticles = (): void => {\r\n        if (!this.context || !this.context.canvas) {\r\n            return;\r\n        }\r\n        const width = this.context.canvas.width;\r\n        const height = this.context.canvas.height;\r\n        let particle: ConfettiParticle;\r\n        this.waveAngle += 0.01;\r\n        for (let i = 0; i < this.particles.length; i++) {\r\n            particle = this.particles[i];\r\n            if (!this.isRunning && particle.y < -15) {\r\n                particle.y = height + 100;\r\n            } else {\r\n                particle.tiltAngle += particle.tiltAngleIncrement;\r\n                particle.x += Math.sin(this.waveAngle) - 0.5;\r\n                particle.y += (Math.cos(this.waveAngle) + particle.diameter + this.options.speed) * 0.5;\r\n                particle.tilt = Math.sin(particle.tiltAngle) * 15;\r\n            }\r\n            if (particle.x > width + 20 || particle.x < -20 || particle.y > height) {\r\n                if (this.isRunning && this.particles.length <= this.options.maxCount) {\r\n                    this.resetParticle(particle, width, height);\r\n                } else {\r\n                    this.particles.splice(i, 1);\r\n                    i--;\r\n                }\r\n            }\r\n        }\r\n    };\r\n}\r\n"],"names":["DefaultOptions","maxCount","speed","frameInterval","alpha","gradient","Confetti","constructor","options","_defineProperty","window","requestAnimationFrame","Date","now","async","canvas","timeout","this","context","getContext","particles","count","length","push","resetParticle","width","height","isRunning","runAnimation","setTimeout","stop","particle","color","colors","Math","random","color2","x","y","diameter","tilt","tiltAngleIncrement","tiltAngle","PI","clearRect","delta","lastFrameTime","supportsAnimationFrame","updateParticles","drawParticles","x2","y2","beginPath","lineWidth","createLinearGradient","addColorStop","strokeStyle","moveTo","lineTo","stroke","waveAngle","i","sin","cos","splice","_objectSpread"],"sourceRoot":""}